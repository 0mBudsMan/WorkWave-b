// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum userRole {
  ASSIGNEE
  ASSIGNER
}

enum taskStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
}

model User {
  id            String         @id @default(auto()) @map("_id") @db.ObjectId
  FirstName     String
  LastName      String
  Email         String         @unique
  Password      String
  Role          userRole
  AssignedTasks Task[]         @relation("Assigner")
  TodoTasks     Task[]         @relation("Assignee")
  Organizations Organization[] @relation("UsersInOrganisation")
}

model Organization {
  id           String   @id @default(auto()) @map("_id") @db.ObjectId
  Name         String
  CreatedById  String   @unique @db.ObjectId
  Tasks        Task[]
  User         User?    @relation(name: "UsersInOrganisation", fields: [UserIds], references: [id])
  UserIds      String[] @db.ObjectId
  AssignersIds String[] @db.ObjectId
}

model Task {
  id             String       @id @default(auto()) @map("_id") @db.ObjectId
  Title          String
  Description    String
  Status         taskStatus   @default(PENDING)
  assignerId     String       @db.ObjectId
  Assigner       User         @relation("Assigner", fields: [assignerId], references: [id])
  assigneeId     String?      @db.ObjectId
  Assignee       User?        @relation("Assignee", fields: [assigneeId], references: [id])
  organizationId String       @unique @db.ObjectId
  Organization   Organization @relation(fields: [organizationId], references: [id])
  StartDate      DateTime
  EndDate        DateTime
}
